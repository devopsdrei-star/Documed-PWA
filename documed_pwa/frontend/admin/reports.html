<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DocuMed</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/style.css?v=docnurse2">
  <link rel="stylesheet" href="../assets/css/docnurse_layout.css?v=1">
  <link rel="icon" type="image/png" href="../assets/images/documed_logo.png" />
</head>
<body>
    <div class="admin-layout" style="box-shadow: 0 8px 32px rgba(37,99,235,0.18); border-radius: 18px; width: 100vw; min-height: 100vh; margin: 0; max-width: none;">
    <aside class="sidebar">
  <div class="logo"><img src="../assets/images/documed_logo.png" alt="DocuMed" /></div>
          <nav class="sidebar-nav">
    <a href="dashboard.html" class="sidebar-link"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a>
    <a href="patients.html" class="sidebar-link"><i class="bi bi-people me-2"></i>Patients</a>
    <a href="appointments.html" class="sidebar-link"><i class="bi bi-calendar-check me-2"></i>Appointments</a>
    <a href="manage_users.html" class="sidebar-link"><i class="bi bi-person-gear me-2"></i>Manage user</a>
    <a href="audit_trail.html" class="sidebar-link"><i class="bi bi-clock-history me-2"></i>Activity log</a> 
    <a href="medicine_inventory.html" class="sidebar-link"><i class="bi bi-capsule me-2"></i>Medicine</a>
  <a href="reports.html" class="sidebar-link active"><i class="bi bi-graph-up me-2"></i>Reports</a>
  <a href="settings.html" class="sidebar-link"><i class="bi bi-gear me-2"></i>Settings</a>
      </nav>
    </aside>
    <main class="main-content">
  <div class="dashboard-topbar" style="display:flex;justify-content:flex-end;align-items:center;margin-bottom:18px;gap:18px;">
    <button id="dashboardSettingsBtn" style="background:none;border:none;cursor:pointer;font-size:1.7rem;color:#2563eb;display:flex;align-items:center;">
    </button>
    <div class="dashboard-profile-dropdown" style="position:relative;">
      <button id="dashboardProfileBtn" style="background:none;border:none;cursor:pointer;display:flex;align-items:center;gap:8px;">
            <img src="../assets/images/documed_logo.png" alt="DocuMed Logo" style="width:38px;height:38px;border-radius:50%;object-fit:cover;box-shadow:0 2px 8px #2563eb22;">
      </button>
      <div id="dashboardProfileMenu" style="display:none;position:absolute;right:0;top:110%;background:#fff;box-shadow:0 2px 8px #2563eb22;border-radius:10px;min-width:160px;z-index:20;">
        <a href="#" id="profileInfoMenu" style="display:block;padding:12px 18px;color:#2563eb;text-decoration:none;font-weight:500;border-bottom:1px solid #f3f4f6;">Profile Info</a>
        <a href="admin_login.html" id="logoutMenu" style="display:block;padding:12px 18px;color:#e11d48;text-decoration:none;font-weight:500;">Logout</a>
      </div>
    </div>
  </div>
  <div id="reports-content" style="max-width:1080px;margin:0 auto;padding:0;background:transparent;box-shadow:none;border-radius:0;">
        <div class="screen-only" style="display:flex;flex-direction:column;align-items:center;justify-content:center;margin:6px 0 16px;gap:4px;text-align:center;">
          <h1 id="reportTitle" style="margin:0;font-size:1.8rem;color:#0f172a;letter-spacing:0.2px;">Clinic Report</h1>
          <div id="reportSubtitle" style="margin:0;color:#64748b;font-weight:600;">
            Select options then click Generate
          </div>
        </div>
        <form id="reportForm" style="display:flex;flex-wrap:wrap;gap:18px 32px;align-items:flex-end;">
          <div style="flex:1 1 220px;min-width:220px;">
            <label for="reportType" style="font-weight:600;color:#000000;margin-bottom:10px;display:block;">Report Type:</label>
            <select id="reportType" name="reportType" style="width:100%;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <option value="illness_stats">Illness Stats</option>
              <option value="clinic_overview">Clinic Overview (Tabular)</option>
            </select>
          </div>
          <!-- Illness Stats specific controls -->
          <div id="illnessDateModeContainer" style="flex:1 1 220px;min-width:220px;display:none;">
            <label for="illnessDateMode" style="font-weight:600;color:#000000;margin-bottom:10px;display:block;">Illness Period:</label>
            <select id="illnessDateMode" name="illnessDateMode" style="width:100%;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <option value="all">All</option>
              <option value="daily">Daily</option>
              <option value="weekly">Weekly</option>
              <option value="monthly">Monthly</option>
            </select>
          </div>
          <div id="audienceContainer" style="flex:1 1 220px;min-width:220px;display:block;">
            <label for="audienceFilter" style="font-weight:600;color:#000000;margin-bottom:10px;display:block;">Patients:</label>
            <select id="audienceFilter" name="audienceFilter" style="width:100%;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <option value="Student">Students</option>
              <option value="Faculty">Faculty</option>
              <option value="Staff">Staff</option>
              <option value="All">All</option>
            </select>
          </div>
          <div id="dateInputs" style="flex:2 1 320px;display:flex;flex-direction:column;gap:8px;">
            <label id="dateLabel" for="dailyDate" style="font-weight:600;color:#000000;margin-bottom:2px;">Date:</label>
            <div id="dateRow" style="display:flex;gap:12px;align-items:center;min-height:48px;flex-wrap:wrap;">
              <input type="date" id="dailyDate" name="dailyDate" style="display:none;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <input type="date" id="weekStart" name="weekStart" style="display:none;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <input type="date" id="weekEnd" name="weekEnd" style="display:none;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <input type="month" id="monthInput" name="monthInput" style="display:none;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <input type="date" id="rangeStart" name="rangeStart" placeholder="Start date" style="display:none;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
              <input type="date" id="rangeEnd" name="rangeEnd" placeholder="End date" style="display:none;padding:10px 14px;border-radius:10px;border:1.5px solid #a5a5a5;background:#f3f4f6;font-size:1rem;">
            </div>
          </div>
            <div style="display:flex;align-items:flex-end;gap:10px;">
        <button type="submit" class="btn" style="background:#2563eb;color:#fff;padding:12px 32px;border-radius:10px;font-size:1.08rem;box-shadow:0 2px 8px rgba(37,99,235,0.08);font-weight:600;">Generate</button>
        <button id="printReportBtn" type="button" class="btn" style="background:#22c55e;color:#fff;padding:12px 28px;border-radius:10px;font-size:1.08rem;box-shadow:0 2px 8px #22c55e22;font-weight:600;">Print PDF</button>
      </div>
        </form>
        <div id="reportResult" style="margin-top:32px;"></div>
        <!-- Tabular clinic overview container (print-friendly) -->
        <div id="clinicOverview" style="margin-top:24px;display:none;">
          <!-- Section navigation -->
          <div id="overviewSectionsNav" style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:12px;">
            <button type="button" class="ov-btn active" data-target="casesSeenContainer">Cases Seen + Top Illnesses</button>
            <button type="button" class="ov-btn" data-target="medicinesTableContainer">Medicines</button>
            <button type="button" class="ov-btn" data-target="servicesTableContainer">Services</button>
            <button type="button" class="ov-btn" data-target="illnessesTableContainer">Illnesses</button>
            <div style="flex:1 1 auto"></div>
            <button type="button" class="ov-btn" id="showAllSectionsBtn">Show All</button>
          </div>
          <div id="casesSeenContainer" class="report-section" style="margin-bottom:18px;"></div>
          <div id="topIllnessContainer" class="report-section page-break" style="margin-bottom:18px;display:none;"></div>
          <div id="medicinesTableContainer" class="report-section page-break" style="margin-bottom:18px;"></div>
          <div id="servicesTableContainer" class="report-section page-break" style="margin-bottom:18px;"></div>
          <div id="illnessesTableContainer" class="report-section page-break" style="margin-bottom:18px;"></div>
        </div>
        <!-- Analytics grid: chart + summary -->
        <div id="analyticsRow" style="display:none;grid-template-columns:minmax(520px,1fr) 360px;gap:24px;align-items:flex-start;margin-top:24px;">
          <div id="pieChartContainer" style="display:flex;justify-content:center;align-items:center;width:100%;">
            <canvas id="pieChart" style="background:#fff;border-radius:12px;box-shadow:0 2px 12px rgba(37,99,235,0.08);"></canvas>
          </div>
          <div id="summaryCard" style="background:#f9fafb;border:1px solid #e5e7eb;border-radius:12px;padding:16px;box-shadow:0 2px 12px rgba(37,99,235,0.06);">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
              <h3 style="margin:0;font-size:1.05rem;color:#111827;">Summary</h3>
              <span id="summaryTotal" style="font-weight:700;color:#2563eb;">Total: 0</span>
            </div>
            <div id="summaryBody" style="display:flex;flex-direction:column;gap:6px;color:#374151;font-size:0.95rem;"></div>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="../assets/js/reports.js"></script>
  <style>
    /* Pills/buttons */
    .ov-btn { background:#f3f4f6; color:#111; border:1px solid #e5e7eb; padding:8px 12px; border-radius:999px; cursor:pointer; font-weight:600; }
    .ov-btn.active { background:#2563eb; color:#fff; border-color:#2563eb; }
  /* removed cardish styling for plain layout */
    table.report { width:100%; border-collapse:collapse; }
    table.report th, table.report td { border:1px solid #000; padding:4px 6px; font-size:12px; }
    table.report th { font-weight:700; text-transform:uppercase; }
    .section-header { display:flex; align-items:center; justify-content:space-between; gap:12px; margin:8px 0 6px; font-weight:700; }
    .section-print-btn { background:#2563eb; color:#fff; border:1px solid #1d4ed8; padding:6px 10px; border-radius:8px; font-weight:600; cursor:pointer; box-shadow:0 1px 4px rgba(37,99,235,0.18); }
    .section-actions { display:flex; align-items:center; gap:8px; }
    .print-only { display:none; }
    .psu-print-header { text-align:center; margin-bottom:10px; }
    .psu-print-header .line-1 { font-weight:800; font-size:14px; }
    .psu-print-header .line-2 { font-weight:700; font-size:13px; }
    .psu-print-header .line-3 { font-weight:600; font-size:12px; }
  .psu-print-header img { width:80px; height:80px; object-fit:contain; }
  .psu-logo-right { position:absolute; top:0; right:0; }
    .psu-print-header { position:relative; text-align:center; margin-bottom:18px; }
    .print-signatories { display:none; margin-top:16px; }
    .print-signatories .sig-grid { display:grid; grid-template-columns:1fr 1fr; gap:18px 36px; }
    .print-signatories .sig { margin:8px 0; }
    .print-signatories .sig .sig-name { font-weight:700; }
    .screen-only { display:block; }
    #reportSubtitle { font-size:0.98rem; }
  /* print-friendly tables only */
  @media (max-width: 1000px) { }
    @media print {
      body { background: #fff !important; }
      .sidebar, .dashboard-topbar, #reportForm, #reportResult, #analyticsRow, #pieChartContainer { display: none !important; }
    .admin-layout, .main-content, #reports-content, .report-section { background: transparent !important; box-shadow: none !important; }
    * { box-shadow: none !important; text-shadow: none !important; }
      #clinicOverview { display: block !important; }
      .page-break { page-break-before: always; }
      .report-section { page-break-inside: avoid; }
      .ov-btn, #overviewSectionsNav { display:none !important; }
      .chart-box canvas { height:260px !important; }
      .section-print-btn { display:none !important; }
      .section-actions { display:none !important; }
      .print-only { display:block !important; }
      .print-signatories { display:block !important; }
      .screen-only, #reportTitle, #reportSubtitle { display:none !important; }
      /* Hide all images for print except the PSU header logo to avoid large seals/watermarks */
      img { display:none !important; }
      .psu-print-header img { display:inline-block !important; }
    }
  </style>
  <script src="../assets/js/settings_dropdown.js"></script>
  <script src="../assets/js/dashboard_interactive.js"></script>
</body>
</html>
